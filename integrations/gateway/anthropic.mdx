---
title: Anthropic
description: "Use Anthropic SDK through Respan"
---

<Accordion title="Set up Respan">
1. **Sign up** — Create an account at [platform.respan.ai](https://platform.respan.ai)
2. **Create an API key** — Generate one on the [API keys page](https://platform.respan.ai/platform/api/api-keys)
3. **Add credits or a provider key** — Add credits on the [Credits page](https://platform.respan.ai/platform/api/credits) or connect your own provider key on the [Integrations page](https://platform.respan.ai/platform/api/integrations)
</Accordion>


<Note> This integration is for the **Respan gateway**. </Note>

## What is Anthropic SDK?

The [Anthropic](https://www.anthropic.com/) SDK lets you call Claude models directly using Anthropic's native API. By pointing `base_url` to Respan, all requests are routed through the gateway for logging and observability.

<Warning>
This is a pass-through integration. Some features are not available: [user rate limits](/documentation/features/user-analytics/customer-identifier#rate-limits), [fallbacks](/documentation/features/gateway/advanced-configuration#fallback-models), [load balancing](/documentation/features/gateway/advanced-configuration#load-balancing), and direct [prompt management](/documentation/features/prompt-management/quickstart) (use the [Prompts API](/apis/develop/prompts/create-prompts) instead).
</Warning>

<Warning>
**Default max_tokens**: Anthropic requests sent through Respan have a default of 4096 max_tokens. Make sure to explicitly set `max_tokens` in your requests if you need a different value.
</Warning>

## Quickstart

<CodeGroup>
```python Python
import anthropic

client = anthropic.Anthropic(
    base_url="https://api.respan.ai/api/anthropic/",
    api_key="Your_Respan_API_Key",
)

message = client.messages.create(
    model="claude-3-opus-20240229",
    max_tokens=1000,
    system="Respond only in Yoda-speak.",
    messages=[
        {"role": "user", "content": "How are you today?"}
    ],
    metadata={
        "respan_params": {
            "customer_identifier": "something" # You need to wrap the customer_identifier into the "respan_params" key
        }
    },
)

print(message.content)
```
```TypeScript TypeScript
import Anthropic from "@anthropic-ai/sdk";

const anthropic = new Anthropic({
  baseUrl: "https://api.respan.ai/api/anthropic/",  
  apiKey: 'YOUR_RESPAN_API_KEY',
});

const msg = await anthropic.messages.create({
model: "claude-3-5-sonnet-20240620",
max_tokens: 1000,
temperature: 0,
system: "Respond only with short poems.",
messages: [
    {
    "role": "user",
    "content": [
        {
        "type": "text",
        "text": "Why is the ocean salty?"
        }
    ]
    }
],
metadata: {
    "respan_params": {
        "customer_identifier": "something"
    }
}
});
console.log(msg);
```
</CodeGroup>

## Supported parameters

### Extra Headers

You can pass additional headers to be sent with your LLM requests using the `extra_headers` parameter. This is useful for sending custom headers required by specific models or configurations.

<CodeGroup>
```python Python
import anthropic

client = anthropic.Anthropic(
    base_url="https://api.respan.ai/api/anthropic/",
    api_key="Your_Respan_API_Key",
)

message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1000,
    system="Respond only in Yoda-speak.",
    messages=[
        {"role": "user", "content": "Are there an infinite number of prime numbers such that n mod 4 == 3?"}
    ],
    metadata={
        "extra_headers": {
            "anthropic-beta": "context-1m-2025-08-07"
        }
    },
)

print(message.content)
```
```TypeScript TypeScript
import Anthropic from "@anthropic-ai/sdk";

const anthropic = new Anthropic({
  baseUrl: "https://api.respan.ai/api/anthropic/",  
  apiKey: 'YOUR_RESPAN_API_KEY',
});

const msg = await anthropic.messages.create({
  model: "claude-sonnet-4-20250514",
  max_tokens: 1000,
  temperature: 0,
  system: "Respond only with short poems.",
  messages: [
    {
      "role": "user",
      "content": "Are there an infinite number of prime numbers such that n mod 4 == 3?"
    }
  ],
  metadata: {
    "extra_headers": {
      "anthropic-beta": "context-1m-2025-08-07"
    }
  }
});
console.log(msg);
```
</CodeGroup>

<Note>
**Extra Headers**: The `extra_headers` parameter allows you to pass additional headers that will be sent with your LLM request. This is particularly useful for accessing beta features like Claude Sonnet 4's 1M token context window using the `anthropic-beta: context-1m-2025-08-07` header.
</Note>

### Respan parameters

To use [Respan parameters](/apis/develop/gateway/chat-completions#respan-parameters), pass them in the `metadata` parameter under the `respan_params` key. These parameters take precedence over Anthropic parameters if they conflict.

### Nested metadata

You can pass multiple Respan-specific parameters using a nested metadata structure. This allows you to include `custom_identifier`, `customer_identifier`, and additional custom metadata all in one structure:

<CodeGroup>
```python Python
import anthropic

client = anthropic.Anthropic(
    base_url="https://api.respan.ai/api/anthropic/",
    api_key="Your_Respan_API_Key",
)

message = client.messages.create(
    model="claude-3-opus-20240229",
    max_tokens=1000,
    system="Respond only in Yoda-speak.",
    messages=[
        {"role": "user", "content": "How are you today?"}
    ],
    metadata={
        "respan_params": {
            "custom_identifier": "session_id",
            "customer_identifier": "customer_id",
            "metadata": {
                "agent": "orchestrator"
            }
        }
    },
)

print(message.content)
```
```TypeScript TypeScript
import Anthropic from "@anthropic-ai/sdk";

const anthropic = new Anthropic({
  baseUrl: "https://api.respan.ai/api/anthropic/",  
  apiKey: 'YOUR_RESPAN_API_KEY',
});

const msg = await anthropic.messages.create({
  model: "claude-3-5-sonnet-20240620",
  max_tokens: 1000,
  temperature: 0,
  system: "Respond only with short poems.",
  messages: [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "Why is the ocean salty?"
        }
      ]
    }
  ],
  metadata: {
    "respan_params": {
      "custom_identifier": "session_id",
      "customer_identifier": "customer_id",
      "metadata": {
        "agent": "orchestrator"
      }
    }
  }
});
console.log(msg);
```
</CodeGroup>

<Note>
**Nested Metadata Structure**: The `metadata` object should contain a `respan_params` key, which itself contains:
- `custom_identifier`: A custom identifier for tracking specific requests
- `customer_identifier`: An identifier for the customer making the request
- `metadata`: An additional nested object for custom metadata fields (e.g., agent type, workflow stage, etc.)
</Note>


