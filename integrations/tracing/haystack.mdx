---
title: "Haystack"
description: "Trace Haystack pipelines with Respan."
---

<Accordion title="Set up Respan">
1. **Sign up** — Create an account at [platform.respan.ai](https://platform.respan.ai)
2. **Create an API key** — Generate one on the [API keys page](https://platform.respan.ai/platform/api/api-keys)
3. **Add credits or a provider key** — Add credits on the [Credits page](https://platform.respan.ai/platform/api/credits) or connect your own provider key on the [Integrations page](https://platform.respan.ai/platform/api/integrations)
</Accordion>

<Accordion title="Use AI">
Add the [Docs MCP](/documentation/getting-started/ask-ai) to your AI coding tool to get help building with Respan. No API key needed.
```json
{
  "mcpServers": {
    "respan-docs": {
      "url": "https://docs.respan.ai/mcp"
    }
  }
}
```
</Accordion>

## What is Haystack?

[Haystack](https://haystack.deepset.ai/) is a Python framework for building production-ready LLM pipelines. It provides components for retrieval, generation, and processing that can be composed into pipelines.

## Setup

<Steps>
<Step title="Install packages">

```bash
pip install respan-exporter-haystack haystack-ai
```

</Step>

<Step title="Set environment variables">

```bash
export RESPAN_API_KEY="YOUR_RESPAN_API_KEY"
export OPENAI_API_KEY="YOUR_OPENAI_API_KEY"
```

</Step>

<Step title="Add RespanConnector to your pipeline">

```python
from haystack import Pipeline
from haystack.components.generators import OpenAIGenerator
from respan_exporter_haystack import RespanConnector

pipeline = Pipeline()
pipeline.add_component("respan", RespanConnector(api_key="your-api-key"))
pipeline.add_component("llm", OpenAIGenerator(model="gpt-4o-mini"))
pipeline.connect("respan", "llm")

result = pipeline.run({"respan": {"prompt": "Tell me a joke about AI"}})
print(result)
```

</Step>

<Step title="View your trace">

Open the [Traces page](https://platform.respan.ai/platform/traces) to see your pipeline trace.

<Frame className="rounded-md">
<img width="100%" src="https://keywordsai-static.s3.us-east-1.amazonaws.com/docs/integrations/tracing/haystack/haystack-trace.png" alt="Haystack pipeline trace" />
</Frame>

</Step>
</Steps>

## Configuration

See the [Haystack Exporter SDK reference](/sdks/python/exporters/haystack) for the full API.

| Component | Description |
|-----------|-------------|
| `RespanConnector` | Connects pipelines to Respan for tracing. |
| `RespanTracer` | Alternative tracing integration. |
| `RespanGenerator` | Routes LLM calls through the Respan gateway. |
| `RespanChatGenerator` | Chat-specific gateway component. |

## Attributes

Pass Respan attributes through the connector:

```python
result = pipeline.run({
    "respan": {
        "prompt": "Tell me a joke",
        "customer_identifier": "user-123",
        "metadata": {"team": "ml"},
    }
})
```

| Attribute | Description |
|-----------|-------------|
| `customer_identifier` | User/customer identifier. |
| `metadata` | Custom key-value pairs. |

## Prompts

Use Respan-managed prompts in Haystack pipelines:

```python
from respan_exporter_haystack import RespanGenerator

generator = RespanGenerator(
    api_key="your-api-key",
    model="gpt-4o-mini",
    prompt_id="your-prompt-id",
    prompt_version=1,
)
```

<Note>
Looking for gateway integration? See [Gateway > Haystack](/integrations/gateway/haystack).
</Note>

